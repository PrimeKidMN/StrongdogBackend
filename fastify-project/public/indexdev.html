<!DOCTYPE html>
<script
  async
  src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1609993827735056"
  crossorigin="anonymous"
></script>
<html lang="en">
  <head>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-database-compat.js"></script>
    <script type="module">
      // Keys for various games
      const polytrackKeys = [
        "v1_record_445edfa992d0b19b376c8072692f69eafc4afeceb608ba355d44b3cb57a902a0",
        "v1_record_55a26267e4fa6a176ba5898b3e1354d54bbf7c02ed0fd3f37e4e3cee56724a8a",
        "v1_record_60b9020ffd46fa428ce40ab2e610992d4bcd2df68f00005c6b88544ce134f950",
        "v1_record_764e05d5eb827c3b608b288cdffc3dc29be2abcc5d29cf958b029badf1564417",
        "v1_record_8b4383a77d1f900b5beff053aee8a1bc47a733778dac54f6ecca0dd6cffeec80",
        "v1_record_ed65907f59ece7a863e9f1ea1e2b50714920899f7d2e42d9b9656bcb8382b66a",
        "v1_record_f67a25877dbbdb5287f9191cda506a254b0ca7a95fde82e34951fe55bb04c172",
      ];
      const babelTowerKeys = [
        "Tower_id",
        "W_3_numGiftsAlreadyGiven",
        "W_3_timeOfNextGift",
        "save_version",
        "save_date",
        "save_data",
      ];
      const idleSharkKey = ["sharkGameSave"];
      const cookieClickerKey = ["CookieClickerGame"];
      const badEggKeys = [
        "vms--u",
        "vms--logger-settings",
        "vms--reload-manager-enabled",
        "vms--mod-geo",
        "vms--vm-abd",
      ];

      function getParsedItem(key) {
        const item = localStorage.getItem(key);
        try {
          return JSON.parse(item);
        } catch (error) {
          console.warn(`Invalid JSON for key: ${key} Error: ${error}`);
          return item;
        }
      }

      function copyText(text) {
        navigator.clipboard
          .writeText(text)
          .then(() => showTransferInstructions())
          .catch((err) =>
            alert(`Error: failed to copy your save data: ${err}`)
          );
      }

      function showTransferInstructions() {
        alert(
          "Your save data was successfully copied to your clipboard!\nTo transfer your save data to either strongdogxp.github.io or mathcordxp.github.io, please navigate to the home page of either website and in the red updates box, there will be further instruction.\n\nMAKE SURE to not copy anything to your clipboard before transferring your data!"
        );
      }

      function setDataInObject(dataObj) {
        Object.entries(dataObj).forEach(([key, value]) => {
          if (value !== null) {
            const finalValue =
              typeof value === "string" ? value : JSON.stringify(value);
            localStorage.setItem(key, finalValue);
          }
        });
      }

      function validateData(dataObj) {
        return Object.values(dataObj).every((value) => value !== null);
      }

      function getAndBundleDataIntoObj(keysArr) {
        const dataObj = Object.fromEntries(
          keysArr.map((key) => [key, getParsedItem(key)])
        );
        if (!validateData(dataObj))
          alert(
            "(If you retrieved Polytrack saves this isn't a problem, please move on)\n\nYour save data will be copied, but some could not be retrieved which may cause problems importing this data. Please ensure all required keys of your game save data are present in localStorage and try again.\n\nIf this issue persists, report the error to the bug report form or message us on Discord."
          );
        return JSON.stringify(dataObj);
      }

      function getDataAndCopy(keysArr) {
        const gameData = getAndBundleDataIntoObj(keysArr);
        if (gameData) copyText(gameData);
      }

      document.addEventListener("DOMContentLoaded", function () {
        if (window.location.hostname.includes("netlify.app")) {
          document.body.innerHTML = `
            <div style="padding: 20px; text-align: center; color: white; background-color: #333; font-family: Arial, sans-serif;">
              <p>Hi there! If you're seeing this, you're trying to connect to a StrongDog version hosted on Netlify. Due to Netlify's extreme costs, we're moving back to GitHub with updated links!</p>
              <p>Here are the new links that should be used from now on:</p>
              <p><a href="https://strongdogxp.github.io" style="color: orange;">strongdogxp.github.io</a></p>
              <p><a href="https://mathcordxp.github.io" style="color: orange;">mathcordxp.github.io</a></p>
              <p>If you used to use <strong>stroongdog.netlify.app</strong>, the updated GitHub link is on the Discord in the same place you found the original link.</p>
              <h2>Use these buttons to copy your save data from this page (just strongdog.netlify.app currently) to transfer it over to another StrongDogXP page:</h2>
              <button id="get-polytrack-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Polytrack Save Data</button>
              <button id="get-cookie-clicker-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Cookie Clicker Save Data</button>
              <button id="get-bad-egg-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Bad egg Save Data</button>
              <button id="get-babel-tower-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Babel Tower Save Data</button>
              <button id="get-idle-shark-data" style="background: orange; border-radius: 10px; padding: 1em; color: black; border: none; cursor: pointer;">Retrieve Idle Shark Save Data</button>
              <p>If you cannot figure out how to use these buttons or they simply don't work, report an error in the <a href="./about.html" target="_blank" style="color: deepskyblue">bug report form</a> or message us on Discord.</p>
              <h2><strong>DON'T FORGET TO SET NEW BOOKMARKS! THIS PAGE WILL BE GOING DOWN SOON!</strong></h2>
            </div>
          `;
          document.body.style =
            "height: 100vh; margin: 0; display: grid; place-items: center;";

          const getPolytrackDataBtn =
            document.getElementById("get-polytrack-data");
          const getCookieClickerDataBtn = document.getElementById(
            "get-cookie-clicker-data"
          );
          const getBadEggDataBtn = document.getElementById("get-bad-egg-data");
          const getBabelTowerDataBtn = document.getElementById(
            "get-babel-tower-data"
          );
          const getIdleSharkDataBtn = document.getElementById(
            "get-idle-shark-data"
          );

          getPolytrackDataBtn.addEventListener("click", () =>
            getDataAndCopy(polytrackKeys)
          );
          getCookieClickerDataBtn.addEventListener("click", () =>
            getDataAndCopy(cookieClickerKey)
          );
          getBadEggDataBtn.addEventListener("click", () =>
            getDataAndCopy(badEggKeys)
          );
          getBabelTowerDataBtn.addEventListener("click", () =>
            getDataAndCopy(babelTowerKeys)
          );
          getIdleSharkDataBtn.addEventListener("click", () =>
            getDataAndCopy(idleSharkKey)
          );
        } else {
          const importSaveDataBtn = document.getElementById(
            "import-save-data-btn"
          );
          importSaveDataBtn.addEventListener("click", () => {
            const confirmMessage = confirm(
              `IMPORTANT: note that by confirming this message, you will REWRITE ALL current save data (only on this page) for the game you chose to transfer the data from. If you have records on this page that you don't want to be overridden by records on the site you're transferring data from, cancel this message.\n\nAfter you dismiss this browser alert message, there may be a pop-up asking you to allow this page to "see text copied to the clipboard".\n\nTo be able to transfer your save data and continue, you MUST click ALLOW.`
            );
            if (!confirmMessage) return;
            navigator.clipboard
              .readText()
              .then((text) => {
                if (!text) {
                  throw new Error(
                    "Clipboard is empty. Please copy the data to the clipboard and try again."
                  );
                }

                let parsedData;
                try {
                  parsedData = JSON.parse(text);
                } catch (err) {
                  throw new Error(
                    "Failed to parse clipboard content as JSON. Ensure the data is in valid JSON format."
                  );
                }

                if (typeof parsedData !== "object") {
                  throw new Error(
                    "Invalid data format. The clipboard content must be a JSON object."
                  );
                }

                setDataInObject(parsedData);
                alert(
                  "Your data was successfully transferred! If there are any issues, please contact support."
                );
              })
              .catch((err) =>
                alert(`Failed to read clipboard contents: ${err}`)
              );
          });
        }
      });

      import games from "./cards-data.js";
      import { siteMapping } from "./site-mapping.js";

      function normalizeGameName(name) {
        return name
          .toLowerCase()
          .replace(/\s+/g, "")
          .replace(/[^a-z0-9]/g, "");
      }

      function getCurrentSiteKey() {
        const currentURL = window.location.href;
        const keys = Object.keys(siteMapping);
        keys.sort((a, b) => b.length - a.length);
        for (const key of keys) {
          if (currentURL.includes(key)) {
            return key;
          }
        }
        return null;
      }

      function getAdjustedUrls(href, imgSrc, page) {
        let adjustedHref = href;
        let adjustedImgSrc = `./img/${imgSrc}`;
        const currentSiteKey = getCurrentSiteKey();

        if (currentSiteKey) {
          const currentSitePages = siteMapping[currentSiteKey];
          const pageNumberToURL = {};
          let currentPageNumber = getPageNumberFromURL(currentSiteKey);
          pageNumberToURL[currentPageNumber] = currentSiteKey;

          if (currentSitePages) {
            currentSitePages.forEach((url) => {
              const pageNum = getPageNumberFromURL(url);
              pageNumberToURL[pageNum] = url;
            });
          }

          if (page !== undefined && page !== currentPageNumber) {
            let adjustedBaseURL = pageNumberToURL[page];
            if (!adjustedBaseURL) {
              const currentOrigin = window.location.origin;
              adjustedBaseURL = `${currentOrigin}/strongdog${page}`;
            }
            const adjustedGameHref = href.replace(/^\.\//, "");
            adjustedHref = `${adjustedBaseURL}/${adjustedGameHref}`;
            const adjustedImgPath = imgSrc.replace(/^\.\//, "");
            adjustedImgSrc = `${adjustedBaseURL}/img/${adjustedImgPath}`;
          }
        } else {
          if (page !== undefined && page > 1) {
            const currentOrigin = window.location.origin;
            const adjustedBaseURL = `${currentOrigin}/strongdog${page}`;
            const adjustedGameHref = href.replace(/^\.\//, "");
            adjustedHref = `${adjustedBaseURL}/${adjustedGameHref}`;
            const adjustedImgPath = imgSrc.replace(/^\.\//, "");
            adjustedImgSrc = `${adjustedBaseURL}/img/${adjustedImgPath}`;
          }
        }

        return { adjustedHref, adjustedImgSrc };
      }

      function getPageNumberFromURL(url) {
        const regex = /(strongdog|mathcord|stroongdog)(\d*)/;
        const match = url.match(regex);
        if (match) {
          const pageNum = match[2];
          return pageNum === "" ? 1 : parseInt(pageNum, 10);
        } else {
          return 1;
        }
      }

      function getCardHTML(gameObject) {
        const { href, imgSrc, name, page } = gameObject;
        const { adjustedHref, adjustedImgSrc } = getAdjustedUrls(
          href,
          imgSrc,
          page
        ); // Use original logic for image paths
        const gameLink = `./play/?id=${gameObject.id}`; // Adjusted to use game ID
        const normalizedName = normalizeGameName(name); // Normalize the game name
        return `
    <a href="${gameLink}" class="card" data-game-id="${normalizedName}" data-page="${page}">
        <img src="${adjustedImgSrc}" alt="${name}">
        <figcaption>${name}</figcaption>
    </a>
`;
      }

      let cardsHTMLArr = [];
      for (let i = 0; i < games.length; ++i) {
        cardsHTMLArr.push(getCardHTML(games[i]));
      }

      const cardsHTMLStr = cardsHTMLArr.join("");

      document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("allGameList").innerHTML = cardsHTMLStr;

        const searchInput = document.querySelector(".search-bar");
        const searchResults = document.getElementById("searchResults");

        if (!searchInput || !searchResults) {
          console.error(
            "Search input or results container not found in the DOM."
          );
          return;
        }

        searchInput.addEventListener("focus", function () {
          updateSearchResults();
        });

        searchInput.addEventListener("input", updateSearchResults);

        document.addEventListener("click", function (event) {
          if (
            !searchInput.contains(event.target) &&
            !searchResults.contains(event.target)
          ) {
            searchResults.style.display = "none";
          }
        });

        function updateSearchResults() {
          const searchText = searchInput.value.toLowerCase();
          const filteredGames = games
            .filter((game) => game.name.toLowerCase().includes(searchText))
            .slice(0, 7);

          searchResults.innerHTML = "";
          if (filteredGames.length === 0) {
            searchResults.style.display = "none";
            return;
          }

          filteredGames.forEach((game) => {
            const { id, imgSrc, name } = game;
            const adjustedHref = `./play/?id=${id}`;
            const adjustedImgSrc = `./img/${imgSrc}`;

            const resultLink = document.createElement("a");
            resultLink.href = adjustedHref;
            resultLink.innerHTML = `
            <img src="${adjustedImgSrc}" alt="${name}">
            <span>${name}</span>
        `;
            searchResults.appendChild(resultLink);
          });

          searchResults.style.display = "block";
        }
      });
    </script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyBh-VnGiP4qZD0r14gfn9dr77GwtslpTqU",
        authDomain: "strongdog-auth.firebaseapp.com",
        databaseURL: "https://strongdog-auth-default-rtdb.firebaseio.com",
        projectId: "strongdog-auth",
        storageBucket: "strongdog-auth.appspot.com",
        messagingSenderId: "936276282572",
        appId: "1:936276282572:web:a802b7f609381ff9428669",
        measurementId: "G-0YLTCV2MMS",
      };

      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();
      const rtdb = firebase.database(); // Add this to access Realtime DB
    </script>
    <script src="appscript.js"></script>
    <script>
      function normalizeGameName(name) {
        return name
          .toLowerCase()
          .replace(/\s+/g, "")
          .replace(/[^a-z0-9]/g, "");
      }
      function getTierAndProgressFromXP(xp) {
        const baseXPNeeded = 50; // Starting XP needed
        const increasePerTier = 200; // Fixed increase after cap
        const exponentialMultiplier = 1.2; // Multiplier for exponential increase
        const levelsPerTier = 5; // Levels per tier
        const capTier = 10; // Cap after this many tiers (50 levels total)

        let level = 1;
        let tier = 1;
        let xpNeeded = baseXPNeeded; // Initial XP needed for the first tier

        while (xp >= xpNeeded) {
          xp -= xpNeeded;

          if (tier < capTier) {
            if (level % levelsPerTier === 0) {
              tier++;
              xpNeeded = Math.round(xpNeeded * exponentialMultiplier);
            }
          } else {
            if (level % levelsPerTier === 0) {
              xpNeeded += increasePerTier;
            }
          }

          level++;
        }

        return {
          level,
          tier,
          currentXP: xp,
          xpNeededForNext: xpNeeded,
        };
      }

      document.addEventListener("DOMContentLoaded", function () {
        const topGameList = document.getElementById("topGameList");
        const loadingContainerEl = document.createElement("div");
        loadingContainerEl.className = "loading-container";
        loadingContainerEl.innerHTML = `
          <div class="bars">
            <div class="bar bar-1"></div>
            <div class="bar bar-2"></div>
            <div class="bar bar-3"></div>
            <div class="bar bar-4"></div>
            <div class="bar bar-5"></div>
          </div>
        `;

        topGameList.appendChild(loadingContainerEl);

        function fetchTopGames() {
          fetch(targetUrl, {
            method: "GET",
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error(
                  "Network response was not ok " + response.statusText
                );
              }
              return response.json();
            })
            .then((data) => {
              if (data && data.content) {
                const parsedData = JSON.parse(data.content);
                console.log("Parsed data:", parsedData);
                displayTopGames(parsedData);
              } else {
                console.error("Invalid data format", data);
              }
            })
            .catch((error) => console.error("Error:", error))
            .finally(() => {
              loadingContainerEl.style.display = "none";
            });
        }
        function displayTopGames(games) {
          const topGameList = document.getElementById("topGameList");
          if (!topGameList) {
            console.error("Required element not found.");
            return;
          }

          topGameList.innerHTML = ""; // Clear existing content

          let foundCount = 0;
          let index = 1;
          const displayedGameNames = new Set();

          while (foundCount < 20 && index < games.length) {
            const game = games[index];
            const gameName = game[0];
            const matchingCard = findMatchingCard(gameName);

            if (matchingCard && !displayedGameNames.has(gameName)) {
              // Extract original card info
              const originalImg = matchingCard.querySelector("img");
              const originalName =
                matchingCard.querySelector("figcaption").textContent;
              const originalHref = matchingCard.getAttribute("href");

              // Create a new card identical in structure to the "All" cards
              const cardAnchor = document.createElement("a");
              cardAnchor.href = originalHref;
              cardAnchor.className = "card";

              const imgEl = document.createElement("img");
              imgEl.src = originalImg.src;
              imgEl.alt = originalName;
              cardAnchor.appendChild(imgEl);

              const figcaptionEl = document.createElement("figcaption");
              figcaptionEl.textContent = originalName;
              cardAnchor.appendChild(figcaptionEl);

              // Add the player count overlay
              const playerCountElement = document.createElement("div");
              playerCountElement.className = "player-count";
              playerCountElement.textContent = "Loading players...";
              cardAnchor.appendChild(playerCountElement);

              // Append the card to the top 20 list
              topGameList.appendChild(cardAnchor);

              // Update player count asynchronously
              updatePlayerCount(gameName, playerCountElement);

              displayedGameNames.add(gameName);
              foundCount++;
            }
            index++;
          }

          if (foundCount < 20) {
            console.warn("Could not fill all 20 top slots with unique games.");
          }
        }
        function updatePlayerCount(gameName, playerCountElement) {
          // Use the exact game name without any normalization
          const path = `connections/${gameName}`;

          // Log the game name and Firebase path for debugging
          console.log(`[updatePlayerCount] Using gameName: "${gameName}"`);
          console.log(`[updatePlayerCount] Firebase path: "${path}"`);

          // Reference the specific path in Firebase Realtime Database
          const connectionsRef = rtdb.ref(path);

          // Listen for changes at the specified path
          connectionsRef.on(
            "value",
            (snapshot) => {
              if (snapshot.exists()) {
                const playersOnline = snapshot.numChildren();
                console.log(
                  `[updatePlayerCount] Snapshot exists at "${path}". Players online: ${playersOnline}`
                );
                playerCountElement.textContent = `${playersOnline} Players Online`;
              } else {
                console.log(
                  `[updatePlayerCount] No snapshot found at "${path}". Setting player count to 0.`
                );
                playerCountElement.textContent = "0 Players Online";
              }
            },
            (error) => {
              console.error(`Error fetching data for "${gameName}":`, error);
              playerCountElement.textContent = "0 Players Online";
            }
          );
        }
        function appendPlayerCount(gameName, gameCard) {
          const formattedGameName = gameName.replace(/\s+/g, "_").toLowerCase();
          console.log(`Fetching player count for: ${formattedGameName}`);

          const connectionsRef = rtdb.ref(`connections/${formattedGameName}`);

          const playerCountElement = document.createElement("div");
          playerCountElement.style.color = "black";
          playerCountElement.style.textAlign = "center";
          playerCountElement.style.fontSize = "0.9rem";
          playerCountElement.textContent = "Loading players...";

          // Append this element immediately so it shows up
          gameCard.appendChild(playerCountElement);

          connectionsRef.on(
            "value",
            (snapshot) => {
              const playersOnline = snapshot.exists()
                ? snapshot.numChildren()
                : 0;
              console.log(`Players for ${formattedGameName}: ${playersOnline}`);
              playerCountElement.textContent = `${playersOnline} Players Online`;
            },
            (error) => {
              console.error(
                `Error fetching data for ${formattedGameName}:`,
                error
              );
              playerCountElement.textContent = "0 Players Online";
            }
          );
        }

        function findMatchingCard(gameName) {
          const formattedGameName = normalizeGameName(gameName); // Normalize the gameName from Top 20
          const cards = document.querySelectorAll("#allGameList .card"); // Select all cards

          for (let card of cards) {
            const cardGameId = card.getAttribute("data-game-id"); // Get the data-game-id from the card
            if (cardGameId === formattedGameName) {
              return card; // Return the matching card
            }
          }

          console.warn(`Card not found one of the games.`);
          return null;
        }

        (function () {
          loadingContainerEl.style.display = "flex";
          fetchTopGames();
        })();
      });
    </script>
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StrongDog XP</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #2e2e2e;
      }

      .navbar {
        background-color: #333;
        color: white;
        padding: 10px 20px;
        display: flex;
        align-items: center;
        position: relative;
        justify-content: space-between;
      }

      .logo {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        color: white;
        font-weight: bold;
      }

      .menu-icon {
        font-size: 2rem;
        cursor: pointer;
        margin-left: 20px;
        color: white;
        position: relative;
        z-index: 1001;
      }

      .slide-menu {
        position: fixed;
        top: 0;
        height: 100%;
        width: 350px;
        background-color: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(10px);
        color: white;
        box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
        z-index: 1003;
        transition: transform 0.4s ease;
        overflow-y: auto;
        transform: translateX(-100%);
      }

      .profile-picture-container {
        border-radius: 50%;
        width: 100px;
        aspect-ratio: 1;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
      }

      .profile-picture-container:hover {
        transform: scale(1.05);
        box-shadow: 0 0 25px rgba(255, 255, 255, 0.3);
      }

      .profile-picture {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .user-details-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding-block: 20px;
        gap: 10px;
      }

      .profile-top-container {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .username-container {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .username-text {
        font-size: 1.5rem;
        color: white;
      }

      .categories {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .categories > a {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 20px;
        text-decoration: none;
        color: white;
        transition: all 0.3s ease;
        margin-left: 20px;
        margin-right: 20px;
        text-align: center;
        font-size: 1.1rem;
        position: relative;
        overflow: hidden;
      }

      .categories > a::after {
        content: "";
        background: rgba(255, 255, 255, 0.1);
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border-radius: 50%;
        width: 0;
        height: 0;
        transition: 0.4s ease-out;
      }

      .categories > a:hover::after {
        width: 400px;
        height: 400px;
      }

      .categories > a:hover {
        transform: scale(0.95);
      }

      span.new-feature-tag {
        background: orange;
        border-radius: 100vw;
        padding: 0.2rem 0.4rem;
        margin-left: 1rem;
        font-size: 0.6rem;
        color: black;
        text-transform: uppercase;
      }

      .navbar .logo {
        color: white;
        font-weight: bold;
      }

      .navbar .logo .xp {
        color: orange;
      }

      .navbar a,
      .navbar a:visited,
      .navbar .logo span {
        text-decoration: none;
        margin-right: 20px;
      }

      .search-bar {
        padding: 7px;
        padding-top: 10px;
        font-size: 1em;
        border-radius: 20%;
        width: 100%;
        border: none;
        border-bottom: 5px solid gray;
        background-color: transparent;
        color: white;
      }

      .search-bar:focus {
        outline: none;
        background-color: rgba(255, 255, 255, 0.1);
      }

      .games-grid {
        display: flex;
        flex-wrap: wrap;
        padding: 10px;
        justify-content: center;
      }

      .card {
        background-color: #fff;
        border-radius: 10px;
        margin: 5px;
        width: 120px;
        height: 120px;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        position: relative;
      }

      .card:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.29);
      }

      .card img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
      }

      .card:hover img {
        transform: scale(1.02);
      }

      .card figcaption {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: rgba(95, 95, 95, 0.8);
        color: black;
        padding: 5px 0;
        transition: transform 0.3s ease, opacity 0.3s ease;
        transform: translateY(100%);
        opacity: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        text-shadow: 0 0 2px white;
        font-weight: 550;
        border-radius: 10px;
      }

      .card:hover figcaption {
        height: 30px;
        background-color: rgba(95, 95, 95, 0.8);
        transform: translateY(0);
        opacity: 1;
      }

      .search-results {
        position: absolute;
        right: 20px;
        top: 60px;
        background-color: white;
        color: black;
        border: 1px solid #ccc;
        width: 250px;
        display: none;
        z-index: 1000;
        transform-origin: left;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      .search-results a {
        display: flex;
        align-items: center;
        text-decoration: none;
        color: black;
        border-bottom: 1px solid #eee;
        padding: 5px;
        transition: all 0.3s ease;
      }

      .search-results img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        margin-right: 10px;
        border-radius: 5px;
      }

      .search-results a:last-child {
        border-bottom: none;
      }

      .news-container {
        margin: 20px auto;
        padding: 20px;
        background-color: #444444;
        border-radius: 8px;
        max-width: 800px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .news {
        color: #ffffff;
      }

      .credits-title {
        font-size: 1.5em;
        margin-bottom: 15px;
        color: #ffffff;
        border-bottom: 2px solid #ddd;
        padding-bottom: 5px;
      }

      .credits-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
      }

      .credits-role {
        font-weight: bold;
        color: #ffffff;
      }

      .credits-names {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-items: center;
      }

      .credits-link {
        color: #0073e6;
        text-decoration: none;
        font-weight: bold;
      }

      .credits-link:hover {
        text-decoration: underline;
      }

      .credits-names span {
        color: #c4c4c4;
      }

      h2 {
        text-align: center;
        color: white;
        margin: 20px 0;
        font-size: 1.5em;
      }

      .pagination {
        text-align: center;
        margin: 20px 0;
      }

      .pagination a {
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        transition: background-color 0.3s;
        border: 1px solid #444;
        margin: 0 4px;
        border-radius: 4px;
        background-color: #333;
      }

      .pagination a.active {
        background-color: #555;
        border-color: #777;
      }

      .pagination a:hover:not(.active) {
        background-color: #444;
      }

      .updates-paragraph-text {
        color: white;
        background-color: #a83632;
        padding: 15px 10px;
        border-radius: 10px;
        box-shadow: 0 0 10px 5px rgba(255, 255, 255, 0.05);
        margin-bottom: 30px;
      }

      .updates-text-container {
        margin-left: 30%;
        margin-right: 30%;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .loading-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .bars {
        display: flex;
        align-items: center;
      }

      .bar {
        background-color: rgba(255, 255, 255, 0.3);
        width: 20px;
        height: 40px;
        margin-right: 5px;
        border-radius: 10px;
        animation: load ease infinite 5s;
      }

      .bar-2,
      .bar-4 {
        height: 50px;
      }

      .bar-2 {
        animation-delay: 0.1s;
      }

      .bar-3 {
        height: 60px;
        animation-delay: 0.2s;
      }

      .bar-4 {
        animation-delay: 0.3s;
      }

      .bar-5 {
        animation-delay: 0.4s;
      }

      @keyframes load {
        0%,
        100% {
          transform: rotate(0deg);
        }

        50% {
          transform: rotate(720deg) rotateX(180deg);
        }
      }

      #topGameList {
        position: relative;
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        background-color: #757575;
        padding: 20px;
        border-radius: 10px;
        width: 90%;
        max-width: 400px;
        text-align: center;
      }

      .modal-close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }

      .modal-close:hover,
      .modal-close:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
      }

      .modal-link {
        color: blue;
        text-decoration: underline;
        cursor: pointer;
      }

      .xp-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 10px auto;
        width: 80%;
      }

      .xp-level-text {
        color: white;
        font-size: 1.1rem;
        margin-bottom: 5px;
      }

      .xp-bar {
        position: relative;
        width: 100%;
        height: 20px;
        background: black;
        border-radius: 10px;
        overflow: hidden;
      }

      .xp-bar-fill {
        height: 100%;
        background: linear-gradient(to right, #47fced, #0af);
        width: 0%;
        transition: width 0.5s ease;
      }

      .xp-bar-text {
        position: absolute;
        width: 100%;
        text-align: center;
        color: white;
        font-size: 0.8rem;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
      }
      .player-count {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        background-color: rgba(95, 95, 95, 0.8);
        color: black;
        text-align: center;
        padding: 3px 0;
        font-size: 0.8rem;
        z-index: 2; /* Ensure it appears above the image */
      }
    </style>
  </head>
  <body>
    <div
      id="secretLink"
      title="Secret Menu"
      style="
        position: absolute;
        top: 10px;
        right: 10px;
        width: 10px;
        height: 10px;
        cursor: pointer;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
      "
    ></div>
    <script>
      window.addEventListener("load", function () {
        const secretLink = document.getElementById("secretLink");
        secretLink.addEventListener("click", function () {
          window.location.href = "secret-menu.html";
        });
      });
    </script>

    <div class="navbar">
      <div class="menu-icon" id="menuIcon">&#9776;</div>
      <a href="index.html" class="logo">StrongDog<span class="xp">XP</span></a>

      <div class="search-container">
        <input
          type="text"
          class="search-bar"
          placeholder="Search for games..."
          id="searchInput"
          autocomplete="off"
        />
        <div class="search-results" id="searchResults"></div>
      </div>
    </div>
    <div class="updates-text-container">
      <p class="updates-paragraph-text">
        You can now gain xp and level up on strongdog if you log in and play
        games! Every minute you play is 10 xp, but each level is harder to beat!
        Currently they don't do anything, but who knows, maybe they will
        soon.<br /><br />We also improved the favoriting system, you need to be
        logged in to favorite a game, but it will show in favorites on all your
        signed in devices!
        <button
          id="import-save-data-btn"
          style="
            background: orange;
            border-radius: 10px;
            padding: 1em;
            color: black;
            border: none;
            cursor: pointer;
            margin-inline: auto;
            display: block;
          "
        >
          <strong>Import Save Data</strong>
        </button>
      </p>
    </div>
    <div class="modal" id="popupModal">
      <div class="modal-content">
        <span class="modal-close" id="closeModal">&times;</span>
        <p>
          The strongdog discord server is a place for strongdog users to chill,
          play games together, request ideas, and have fun!
        </p>
        <p>
          If you want to help on StrongDog, there is a chat where you can get
          help downloading games, and you can upload games YOU download to add
          to StrongDog! (And yes, you WILL get credit for downloading games)
        </p>
        <p>
          Ready to join? Click
          <a href="https://discord.gg/pWjfQ4Sz5c" target="_blank">here</a> to
          join the Discord server!
        </p>
      </div>
    </div>
    <h2 style="text-align: center"><strong>Top 20</strong></h2>
    <div class="games-grid" id="topGameList"></div>

    <h2 style="text-align: center"><strong>All</strong></h2>
    <div class="games-grid" id="allGameList"></div>

    <h2 style="text-align: center"><strong>StrongDogXP LLC</strong></h2>

    <div class="news-container">
      <div class="news">
        <div class="credits-item">
          <div class="credits-role">CEO</div>
          <div class="credits-names">
            <a
              href="https://github.com/jman1593"
              target="_blank"
              class="credits-link"
              >Joshua Pettit</a
            >
          </div>
        </div>
        <div class="credits-item">
          <div class="credits-role">Developers</div>
          <div class="credits-names">
            <a
              href="https://github.com/JamesMeadows4"
              target="_blank"
              class="credits-link"
              >James Meadows</a
            >
            <span>|</span>
            <a
              href="https://github.com/jman1593"
              target="_blank"
              class="credits-link"
              >Joshua Pettit</a
            >
          </div>
        </div>
        <div class="credits-item">
          <div class="credits-role">Game Downloaders</div>
          <div class="credits-names">
            <a
              href="https://github.com/jman1593"
              target="_blank"
              class="credits-link"
              >Joshua Pettit</a
            >
            <span>|</span>
            <a
              href="https://maxwellstevenson.com"
              target="_blank"
              class="credits-link"
              >Maxwell Stevenson</a
            >
          </div>
        </div>
        <div class="credits-item">
          <div class="credits-role">Other Links</div>
          <div class="credits-names">
            <a
              href="https://strongdogxp.github.io"
              target="_blank"
              class="credits-link"
              >mathcordxp.github.io</a
            >
            <span>|</span>
            <a
              href="https://strongdogxp.github.io"
              target="_blank"
              class="credits-link"
              >strongdogxp.github.io</a
            >
            <span>|</span>
            <a
              href="https://jman1593.github.io"
              target="_blank"
              class="credits-link"
              >jman1593.github.io</a
            >
            <span>|</span>
            <a
              href="https://strongdog-1.vercel.app"
              target="_blank"
              class="credits-link"
              >strongdog-1.vercel.app</a
            >
            <span>|</span>
            <a href="https://mathcord.com" target="_blank" class="credits-link"
              >mathcord.com</a
            >
            <span>|</span>
            <a href="https://strongdog.com" target="_blank" class="credits-link"
              >strongdog.com</a
            >
          </div>
        </div>
        <div class="credits-item">
          <div class="credits-role">MORE UNBLOCKED LINKS ON THE DISCORD</div>
        </div>
      </div>
    </div>
    <div class="slide-menu" id="slideMenu">
      <div class="categories">
        <a href="favs.html" class="option-link">Favorites</a>
        <a href="#" id="randomGame" class="option-link">Random Game</a>
        <a href="#" id="blockLanschool" class="option-link">Block Lanschool</a>
        <a href="about.html" class="option-link"
          >About | Bugs | Request Games</a
        >
        <a href="https://discord.gg/pWjfQ4Sz5c" class="option-link"
          >Discord Server<span class="new-feature-tag">new</span></a
        >
      </div>
    </div>
    <script type="module">
      import games from "./cards-data.js";

      document.addEventListener("DOMContentLoaded", function () {
        const menuIcon = document.getElementById("menuIcon");
        const slideMenu = document.querySelector(".slide-menu");
        const categories = document.querySelector(".categories");

        menuIcon.addEventListener("click", function (event) {
          event.stopPropagation();
          if (slideMenu.style.transform === "translateX(0%)") {
            slideMenu.style.transform = "translateX(-100%)";
          } else {
            slideMenu.style.transform = "translateX(0%)";
          }
        });

        window.addEventListener("click", function (event) {
          if (event.target !== menuIcon && !slideMenu.contains(event.target)) {
            slideMenu.style.transform = "translateX(-100%)";
          }
        });

        auth.onAuthStateChanged(async (user) => {
          if (user) {
            const userDetailsContainer = document.createElement("div");
            userDetailsContainer.className = "user-details-container";

            const profileTopContainer = document.createElement("div");
            profileTopContainer.className = "profile-top-container";

            const profilePictureContainer = document.createElement("div");
            profilePictureContainer.className = "profile-picture-container";
            const profilePictureElement = document.createElement("img");
            profilePictureElement.className = "profile-picture";
            profilePictureContainer.appendChild(profilePictureElement);

            const usernameContainer = document.createElement("div");
            usernameContainer.className = "username-container";
            const usernameElement = document.createElement("p");
            usernameElement.className = "username-text";
            usernameContainer.appendChild(usernameElement);

            profileTopContainer.appendChild(profilePictureContainer);
            profileTopContainer.appendChild(usernameContainer);

            userDetailsContainer.appendChild(profileTopContainer);

            if (user.photoURL) {
              profilePictureElement.src = user.photoURL;
            } else {
              profilePictureElement.src = "img/default-avatar.png";
            }

            const userId = user.uid;
            const userDocRef = db.collection("usernames").doc(userId);
            const userDoc = await userDocRef.get();

            if (userDoc.exists) {
              const userData = userDoc.data();
              usernameElement.textContent = userData.username || "Username";
            } else {
              usernameElement.textContent = user.displayName || "Username";
            }
            // Fetch total XP from Realtime Database
            const xpRef = rtdb.ref(`xp/${userId}`);
            xpRef.once("value", (snapshot) => {
              let totalXP = 0;
              if (snapshot.exists()) {
                totalXP = snapshot.val();
              } else {
                totalXP = 0;
              }

              // Calculate level, tier, and progress
              const { level, tier, currentXP, xpNeededForNext } =
                getTierAndProgressFromXP(totalXP);

              const xpContainer = document.createElement("div");
              xpContainer.className = "xp-container";

              const xpLevelText = document.createElement("div");
              xpLevelText.className = "xp-level-text";
              xpLevelText.textContent = `Level ${level}`;

              const xpBar = document.createElement("div");
              xpBar.className = "xp-bar";

              const xpBarFill = document.createElement("div");
              xpBarFill.className = "xp-bar-fill";
              const fillPercent = (currentXP / xpNeededForNext) * 100;
              xpBarFill.style.width = `${fillPercent}%`;

              const xpBarText = document.createElement("div");
              xpBarText.className = "xp-bar-text";
              xpBarText.textContent = `${currentXP}/${xpNeededForNext}`;

              xpBar.appendChild(xpBarFill);
              xpBar.appendChild(xpBarText);
              xpContainer.appendChild(xpLevelText);
              xpContainer.appendChild(xpBar);

              userDetailsContainer.appendChild(xpContainer);

              profilePictureContainer.addEventListener("click", () => {
                window.location.href = "settings.html";
              });

              slideMenu.insertBefore(userDetailsContainer, categories);

              const logoutLink = document.createElement("a");
              logoutLink.href = "#";
              logoutLink.className = "option-link";
              logoutLink.textContent = "Log Out";
              logoutLink.style.backgroundColor = "#dc3545";
              logoutLink.style.color = "white";

              logoutLink.addEventListener("click", function (e) {
                e.preventDefault();
                auth
                  .signOut()
                  .then(() => {
                    window.location.reload();
                  })
                  .catch((error) => {
                    console.error("Error signing out:", error);
                  });
              });

              const favoritesLink = categories.querySelector(
                'a[href="favs.html"]'
              );
              categories.insertBefore(logoutLink, favoritesLink);

              try {
                const accessDocRef = db.collection("access").doc(user.uid);
                accessDocRef.get().then((accessDoc) => {
                  if (accessDoc.exists) {
                    const accessData = accessDoc.data();
                    if (accessData.tester === true) {
                      const testGamesLink = document.createElement("a");
                      testGamesLink.href = "test.html";
                      testGamesLink.className = "option-link";
                      testGamesLink.textContent = "Test Games";
                      testGamesLink.style.backgroundColor = "#28a745";
                      testGamesLink.style.color = "white";
                      testGamesLink.style.marginTop = "10px";

                      testGamesLink.addEventListener("mouseover", function () {
                        testGamesLink.style.backgroundColor = "#218838";
                      });
                      testGamesLink.addEventListener("mouseout", function () {
                        testGamesLink.style.backgroundColor = "#28a745";
                      });

                      categories.insertBefore(testGamesLink, favoritesLink);
                    }
                  }
                });
              } catch (error) {
                console.error();
              }
            }); // end xpRef.once
          } else {
            const userDetailsContainer = document.createElement("div");
            userDetailsContainer.className = "user-details-container";

            const notLoggedInContainer = document.createElement("div");
            notLoggedInContainer.className = "username-container";

            const notLoggedInText = document.createElement("p");
            notLoggedInText.className = "username-text";
            notLoggedInText.textContent = "Not logged in";

            notLoggedInContainer.appendChild(notLoggedInText);

            const loginButton = document.createElement("button");
            loginButton.textContent = "Log In";
            loginButton.style.backgroundColor = "#007bff";
            loginButton.style.color = "white";
            loginButton.style.border = "none";
            loginButton.style.padding = "10px 20px";
            loginButton.style.fontSize = "16px";
            loginButton.style.borderRadius = "5px";
            loginButton.style.cursor = "pointer";
            loginButton.style.marginTop = "5px";

            loginButton.addEventListener("click", function () {
              window.location.href = "login.html";
            });

            userDetailsContainer.style.display = "flex";
            userDetailsContainer.style.flexDirection = "column";
            userDetailsContainer.style.alignItems = "center";
            userDetailsContainer.style.paddingBlock = "20px";

            userDetailsContainer.appendChild(notLoggedInContainer);
            userDetailsContainer.appendChild(loginButton);
            slideMenu.insertBefore(userDetailsContainer, categories);
          }

          categories
            .querySelector("#randomGame")
            .addEventListener("click", function (e) {
              e.preventDefault();
              handleRandomGameClick();
            });

          categories
            .querySelector("#blockLanschool")
            .addEventListener("click", function (e) {
              e.preventDefault();
              handleBlockLanschoolClick();
            });

          function handleRandomGameClick() {
            if (games.length > 0) {
              const randomIndex = Math.floor(Math.random() * games.length);
              const randomGamePath = games[randomIndex].href;
              window.location.href = randomGamePath;
            } else {
              console.error("No game paths available for selection.");
            }
          }

          function handleBlockLanschoolClick() {
            var url = "https://strongdogxp.github.io";
            var newTab = window.open();
            newTab.document.write(`
              <html>
                <body style="margin: 0; height: 100vh;">
                  <iframe src="${url}" style="border: none; width: 100%; height: 100%;"></iframe>
                </body>
              </html>
            `);
            newTab.document.close();
          }
        });
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const discordLink = document.getElementById("discordLink");
        const modal = document.getElementById("popupModal");
        const closeModal = document.getElementById("closeModal");

        if (discordLink) {
          discordLink.addEventListener("click", function () {
            modal.style.display = "flex";
          });
        }

        if (closeModal) {
          closeModal.addEventListener("click", function () {
            modal.style.display = "none";
          });
        }

        window.addEventListener("click", function (event) {
          if (event.target === modal) {
            modal.style.display = "none";
          }
        });
      });
    </script>
    <script type="module">
      import games from "./cards-data.js";
      import { siteMapping } from "./site-mapping.js";

      document.addEventListener("DOMContentLoaded", function () {
        const searchInput = document.querySelector(".search-bar");
        const searchResults = document.getElementById("searchResults");

        if (!searchInput || !searchResults) {
          console.error("Search input or results container not found.");
          return;
        }

        searchInput.addEventListener("focus", updateSearchResults);
        searchInput.addEventListener("input", updateSearchResults);

        document.addEventListener("click", function (event) {
          if (
            !searchInput.contains(event.target) &&
            !searchResults.contains(event.target)
          ) {
            searchResults.style.display = "none";
          }
        });

        function updateSearchResults() {
          const searchText = searchInput.value.toLowerCase();
          const filteredGames = games
            .filter((game) => game.name.toLowerCase().includes(searchText))
            .slice(0, 7);

          searchResults.innerHTML = "";
          if (filteredGames.length === 0) {
            searchResults.style.display = "none";
            return;
          }

          const currentURL = window.location.href;
          let matchedKey = null;

          for (const key in siteMapping) {
            if (currentURL.includes(key)) {
              matchedKey = key;
              break;
            }
          }

          if (!matchedKey) {
            console.warn(
              `No site mapping found for current URL: ${currentURL}`
            );
          }

          filteredGames.forEach((game) => {
            const { id, imgSrc, name, page } = game;
            const adjustedHref = `./play/?id=${id}`; // Only updated the href to use the game ID
            let adjustedImgSrc = `./img/${imgSrc}`;

            if (page >= 2 && matchedKey) {
              const pageIndex = page - 2;
              const pageBaseURLs = siteMapping[matchedKey];

              if (pageBaseURLs && pageIndex < pageBaseURLs.length) {
                const pageBaseURL = pageBaseURLs[pageIndex];
                const adjustedImgPath = imgSrc.replace(/^\.\//, "");
                adjustedImgSrc = `${pageBaseURL}/img/${adjustedImgPath}`;
              } else {
                console.warn(
                  `No site mapping found for page ${page} on hostname: ${matchedKey}`
                );
              }
            }

            const resultLink = document.createElement("a");
            resultLink.href = adjustedHref; // Use the new ID-based path
            resultLink.innerHTML = `
            <img src="${adjustedImgSrc}" alt="${name}">
            <span>${name}</span>
        `;
            searchResults.appendChild(resultLink);
          });

          searchResults.style.display = "block";
        }
      });
    </script>
  </body>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const page1Link = document.getElementById("page1-link");
      const page2Link = document.getElementById("page2-link");
      const hostname = window.location.hostname;

      const linkMap = {
        "jman1593.github.io": { page1: "/#", page2: "/strongdog2/index.html" },
        "strongdog-1.vercel.app": {
          page1: "https://strongdog-1.vercel.app",
          page2: "https://strongdog2.vercel.app",
        },
        "strongdog2.vercel.app": {
          page1: "https://strongdog-1.vercel.app",
          page2: "https://strongdog2.vercel.app",
        },
        "strongdog.netlify.app": {
          page1: "https://strongdog.netlify.app",
          page2: "https://strongdog2.netlify.app",
        },
        "strongdog2.netlify.app": {
          page1: "https://strongdog.netlify.app",
          page2: "https://strongdog2.netlify.app",
        },
        "mathcord.netlify.app": {
          page1: "https://mathcord.netlify.app",
          page2: "https://mathcord2.netlify.app",
        },
        "mathcord2.netlify.app": {
          page1: "https://mathcord.netlify.app",
          page2: "https://mathcord2.netlify.app",
        },
        "strongdog.onrender.com": {
          page1: "https://strongdog.onrender.com",
          page2: "https://strongdog2.onrender.com",
        },
        "stroongdog.netlify.app": {
          page1: "https://stroongdog.netlify.app",
          page2: "https://stroongdog2.netlify.app",
        },
        "stroongdog2.netlify.app": {
          page1: "https://stroongdog.netlify.app",
          page2: "https://stroongdog2.netlify.app",
        },
      };

      for (const key in linkMap) {
        if (hostname.includes(key)) {
          page1Link.href = linkMap[key].page1;
          page2Link.href = linkMap[key].page2;
          break;
        }
      }
    });
  </script>
  <script>
    document
      .getElementById("secretLink")
      .addEventListener("click", function () {
        window.location.href = "secret-menu.html";
      });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const discordLink = document.getElementById("discordLink");
      const modal = document.getElementById("popupModal");
      const closeModal = document.getElementById("closeModal");

      if (discordLink) {
        discordLink.addEventListener("click", function () {
          modal.style.display = "flex";
        });
      }

      if (closeModal) {
        closeModal.addEventListener("click", function () {
          modal.style.display = "none";
        });
      }

      window.addEventListener("click", function (event) {
        if (event.target === modal) {
          modal.style.display = "none";
        }
      });
    });
  </script>
  <script type="module">
    import games from "./cards-data.js";

    document.addEventListener("DOMContentLoaded", function () {
      const randomGameButton = document.getElementById("randomGame");

      function handleRandomGameClick() {
        if (games.length > 0) {
          const randomIndex = Math.floor(Math.random() * games.length);
          const randomGamePath = games[randomIndex].href;
          window.location.href = randomGamePath;
        } else {
          console.error("No game paths available for selection.");
        }
      }

      if (randomGameButton) {
        randomGameButton.addEventListener("click", function (event) {
          event.preventDefault();
          handleRandomGameClick();
        });
      }
    });
  </script>
</html>
